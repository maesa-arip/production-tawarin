import{r as b,R as F}from"./app.37a13150.js";import{H as T,x as K,y as w,o as y,b as D,u as P,C as j,p as Q,g as B,_ as k,I as E,d as $,s as V,e as U}from"./transition.ee5c0203.js";import{i as N}from"./use-computed.eef6f6b6.js";import{c as G,h as q,b as W,d as _,t as J,S as X,g as Y,o as d,f as S,r as Z,x as ee,v as te}from"./XIcon.1125be64.js";import{e as re}from"./form.0980e256.js";var oe=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(oe||{}),ne=(e=>(e[e.Single=0]="Single",e[e.Multi=1]="Multi",e))(ne||{}),ae=(e=>(e[e.Pointer=0]="Pointer",e[e.Other=1]="Other",e))(ae||{}),ie=(e=>(e[e.OpenListbox=0]="OpenListbox",e[e.CloseListbox=1]="CloseListbox",e[e.SetDisabled=2]="SetDisabled",e[e.SetOrientation=3]="SetOrientation",e[e.GoToOption=4]="GoToOption",e[e.Search=5]="Search",e[e.ClearSearch=6]="ClearSearch",e[e.RegisterOption=7]="RegisterOption",e[e.UnregisterOption=8]="UnregisterOption",e))(ie||{});function M(e,a=r=>r){let r=e.activeOptionIndex!==null?e.options[e.activeOptionIndex]:null,t=te(a(e.options.slice()),n=>n.dataRef.current.domRef.current),o=r?t.indexOf(r):null;return o===-1&&(o=null),{options:t,activeOptionIndex:o}}let le={[1](e){return e.disabled||e.listboxState===1?e:{...e,activeOptionIndex:null,listboxState:1}},[0](e){if(e.disabled||e.listboxState===0)return e;let a=e.activeOptionIndex,{value:r,mode:t,compare:o}=e.propsRef.current,n=e.options.findIndex(s=>{let l=s.dataRef.current.value;return P(t,{[1]:()=>r.some(p=>o(p,l)),[0]:()=>o(r,l)})});return n!==-1&&(a=n),{...e,listboxState:0,activeOptionIndex:a}},[2](e,a){return e.disabled===a.disabled?e:{...e,disabled:a.disabled}},[3](e,a){return e.orientation===a.orientation?e:{...e,orientation:a.orientation}},[4](e,a){var r;if(e.disabled||e.listboxState===1)return e;let t=M(e),o=ee(a,{resolveItems:()=>t.options,resolveActiveIndex:()=>t.activeOptionIndex,resolveId:n=>n.id,resolveDisabled:n=>n.dataRef.current.disabled});return{...e,...t,searchQuery:"",activeOptionIndex:o,activationTrigger:(r=a.trigger)!=null?r:1}},[5]:(e,a)=>{if(e.disabled||e.listboxState===1)return e;let r=e.searchQuery!==""?0:1,t=e.searchQuery+a.value.toLowerCase(),o=(e.activeOptionIndex!==null?e.options.slice(e.activeOptionIndex+r).concat(e.options.slice(0,e.activeOptionIndex+r)):e.options).find(s=>{var l;return!s.dataRef.current.disabled&&((l=s.dataRef.current.textValue)==null?void 0:l.startsWith(t))}),n=o?e.options.indexOf(o):-1;return n===-1||n===e.activeOptionIndex?{...e,searchQuery:t}:{...e,searchQuery:t,activeOptionIndex:n,activationTrigger:1}},[6](e){return e.disabled||e.listboxState===1||e.searchQuery===""?e:{...e,searchQuery:""}},[7]:(e,a)=>{let r={id:a.id,dataRef:a.dataRef},t=M(e,o=>[...o,r]);if(e.activeOptionIndex===null){let{value:o,mode:n,compare:s}=e.propsRef.current,l=a.dataRef.current.value;P(n,{[1]:()=>o.some(p=>s(p,l)),[0]:()=>s(o,l)})&&(t.activeOptionIndex=t.options.indexOf(r))}return{...e,...t}},[8]:(e,a)=>{let r=M(e,t=>{let o=t.findIndex(n=>n.id===a.id);return o!==-1&&t.splice(o,1),t});return{...e,...r,activationTrigger:1}}},H=b.exports.createContext(null);H.displayName="ListboxContext";function A(e){let a=b.exports.useContext(H);if(a===null){let r=new Error(`<${e} /> is missing a parent <Listbox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,A),r}return a}function se(e,a){return P(a.type,le,e,a)}let ue=b.exports.Fragment,pe=T(function(e,a){let{value:r,name:t,onChange:o,disabled:n=!1,horizontal:s=!1,multiple:l=!1,...p}=e;const g=s?"horizontal":"vertical";let L=w(a),h=b.exports.useReducer(se,{listboxState:1,propsRef:{current:{value:r,onChange:o,mode:l?1:0,compare:y((R,O)=>R===O)}},labelRef:b.exports.createRef(),buttonRef:b.exports.createRef(),optionsRef:b.exports.createRef(),disabled:n,orientation:g,options:[],searchQuery:"",activeOptionIndex:null,activationTrigger:1}),[{listboxState:f,propsRef:m,optionsRef:x,buttonRef:c},i]=h;m.current.value=r,m.current.mode=l?1:0,D(()=>{m.current.onChange=R=>P(m.current.mode,{[0](){return o(R)},[1](){let O=m.current.value.slice(),v=O.indexOf(R);return v===-1?O.push(R):O.splice(v,1),o(O)}})},[o,m]),D(()=>i({type:2,disabled:n}),[n]),D(()=>i({type:3,orientation:g}),[g]),G([c,x],(R,O)=>{var v;i({type:1}),X(O,Y.Loose)||(R.preventDefault(),(v=c.current)==null||v.focus())},f===0);let u=b.exports.useMemo(()=>({open:f===0,disabled:n}),[f,n]),C={ref:L};return F.createElement(H.Provider,{value:h},F.createElement(j,{value:P(f,{[0]:Q.Open,[1]:Q.Closed})},t!=null&&r!=null&&re({[t]:r}).map(([R,O])=>F.createElement(q,{features:W.Hidden,...B({key:R,as:"input",type:"hidden",hidden:!0,readOnly:!0,name:R,value:O})})),k({ourProps:C,theirProps:p,slot:u,defaultTag:ue,name:"Listbox"})))}),ce="button",de=T(function(e,a){var r;let[t,o]=A("Listbox.Button"),n=w(t.buttonRef,a),s=`headlessui-listbox-button-${E()}`,l=$(),p=y(c=>{switch(c.key){case d.Space:case d.Enter:case d.ArrowDown:c.preventDefault(),o({type:0}),l.nextFrame(()=>{t.propsRef.current.value||o({type:4,focus:S.First})});break;case d.ArrowUp:c.preventDefault(),o({type:0}),l.nextFrame(()=>{t.propsRef.current.value||o({type:4,focus:S.Last})});break}}),g=y(c=>{switch(c.key){case d.Space:c.preventDefault();break}}),L=y(c=>{if(Z(c.currentTarget))return c.preventDefault();t.listboxState===0?(o({type:1}),l.nextFrame(()=>{var i;return(i=t.buttonRef.current)==null?void 0:i.focus({preventScroll:!0})})):(c.preventDefault(),o({type:0}))}),h=N(()=>{if(t.labelRef.current)return[t.labelRef.current.id,s].join(" ")},[t.labelRef.current,s]),f=b.exports.useMemo(()=>({open:t.listboxState===0,disabled:t.disabled}),[t]),m=e,x={ref:n,id:s,type:_(e,t.buttonRef),"aria-haspopup":!0,"aria-controls":(r=t.optionsRef.current)==null?void 0:r.id,"aria-expanded":t.disabled?void 0:t.listboxState===0,"aria-labelledby":h,disabled:t.disabled,onKeyDown:p,onKeyUp:g,onClick:L};return k({ourProps:x,theirProps:m,slot:f,defaultTag:ce,name:"Listbox.Button"})}),fe="label",ve=T(function(e,a){let[r]=A("Listbox.Label"),t=`headlessui-listbox-label-${E()}`,o=w(r.labelRef,a),n=y(()=>{var l;return(l=r.buttonRef.current)==null?void 0:l.focus({preventScroll:!0})}),s=b.exports.useMemo(()=>({open:r.listboxState===0,disabled:r.disabled}),[r]);return k({ourProps:{ref:o,id:t,onClick:n},theirProps:e,slot:s,defaultTag:fe,name:"Listbox.Label"})}),be="ul",xe=K.RenderStrategy|K.Static,Re=T(function(e,a){var r;let[t,o]=A("Listbox.Options"),n=w(t.optionsRef,a),s=`headlessui-listbox-options-${E()}`,l=$(),p=$(),g=V(),L=(()=>g!==null?g===Q.Open:t.listboxState===0)();b.exports.useEffect(()=>{var i;let u=t.optionsRef.current;!u||t.listboxState===0&&u!==((i=J(u))==null?void 0:i.activeElement)&&u.focus({preventScroll:!0})},[t.listboxState,t.optionsRef]);let h=y(i=>{switch(p.dispose(),i.key){case d.Space:if(t.searchQuery!=="")return i.preventDefault(),i.stopPropagation(),o({type:5,value:i.key});case d.Enter:if(i.preventDefault(),i.stopPropagation(),t.activeOptionIndex!==null){let{dataRef:u}=t.options[t.activeOptionIndex];t.propsRef.current.onChange(u.current.value)}t.propsRef.current.mode===0&&(o({type:1}),U().nextFrame(()=>{var u;return(u=t.buttonRef.current)==null?void 0:u.focus({preventScroll:!0})}));break;case P(t.orientation,{vertical:d.ArrowDown,horizontal:d.ArrowRight}):return i.preventDefault(),i.stopPropagation(),o({type:4,focus:S.Next});case P(t.orientation,{vertical:d.ArrowUp,horizontal:d.ArrowLeft}):return i.preventDefault(),i.stopPropagation(),o({type:4,focus:S.Previous});case d.Home:case d.PageUp:return i.preventDefault(),i.stopPropagation(),o({type:4,focus:S.First});case d.End:case d.PageDown:return i.preventDefault(),i.stopPropagation(),o({type:4,focus:S.Last});case d.Escape:return i.preventDefault(),i.stopPropagation(),o({type:1}),l.nextFrame(()=>{var u;return(u=t.buttonRef.current)==null?void 0:u.focus({preventScroll:!0})});case d.Tab:i.preventDefault(),i.stopPropagation();break;default:i.key.length===1&&(o({type:5,value:i.key}),p.setTimeout(()=>o({type:6}),350));break}}),f=N(()=>{var i,u,C;return(C=(i=t.labelRef.current)==null?void 0:i.id)!=null?C:(u=t.buttonRef.current)==null?void 0:u.id},[t.labelRef.current,t.buttonRef.current]),m=b.exports.useMemo(()=>({open:t.listboxState===0}),[t]),x=e,c={"aria-activedescendant":t.activeOptionIndex===null||(r=t.options[t.activeOptionIndex])==null?void 0:r.id,"aria-multiselectable":t.propsRef.current.mode===1?!0:void 0,"aria-labelledby":f,"aria-orientation":t.orientation,id:s,onKeyDown:h,role:"listbox",tabIndex:0,ref:n};return k({ourProps:c,theirProps:x,slot:m,defaultTag:be,features:xe,visible:L,name:"Listbox.Options"})}),me="li",Oe=T(function(e,a){let{disabled:r=!1,value:t,...o}=e,[n,s]=A("Listbox.Option"),l=`headlessui-listbox-option-${E()}`,p=n.activeOptionIndex!==null?n.options[n.activeOptionIndex].id===l:!1,{value:g,compare:L}=n.propsRef.current,h=P(n.propsRef.current.mode,{[1]:()=>g.some(v=>L(v,t)),[0]:()=>L(g,t)}),f=b.exports.useRef(null),m=w(a,f);D(()=>{if(n.listboxState!==0||!p||n.activationTrigger===0)return;let v=U();return v.requestAnimationFrame(()=>{var I,z;(z=(I=f.current)==null?void 0:I.scrollIntoView)==null||z.call(I,{block:"nearest"})}),v.dispose},[f,p,n.listboxState,n.activationTrigger,n.activeOptionIndex]);let x=b.exports.useRef({disabled:r,value:t,domRef:f});D(()=>{x.current.disabled=r},[x,r]),D(()=>{x.current.value=t},[x,t]),D(()=>{var v,I;x.current.textValue=(I=(v=f.current)==null?void 0:v.textContent)==null?void 0:I.toLowerCase()},[x,f]);let c=y(()=>n.propsRef.current.onChange(t));D(()=>(s({type:7,id:l,dataRef:x}),()=>s({type:8,id:l})),[x,l]);let i=y(v=>{if(r)return v.preventDefault();c(),n.propsRef.current.mode===0&&(s({type:1}),U().nextFrame(()=>{var I;return(I=n.buttonRef.current)==null?void 0:I.focus({preventScroll:!0})}))}),u=y(()=>{if(r)return s({type:4,focus:S.Nothing});s({type:4,focus:S.Specific,id:l})}),C=y(()=>{r||p||s({type:4,focus:S.Specific,id:l,trigger:0})}),R=y(()=>{r||!p||s({type:4,focus:S.Nothing})}),O=b.exports.useMemo(()=>({active:p,selected:h,disabled:r}),[p,h,r]);return k({ourProps:{id:l,ref:m,role:"option",tabIndex:r===!0?void 0:-1,"aria-disabled":r===!0?!0:void 0,"aria-selected":h===!0?!0:void 0,disabled:void 0,onClick:i,onFocus:u,onPointerMove:C,onMouseMove:C,onPointerLeave:R,onMouseLeave:R},theirProps:o,slot:O,defaultTag:me,name:"Listbox.Option"})}),Le=Object.assign(pe,{Button:de,Label:ve,Options:Re,Option:Oe});export{Le as r};
