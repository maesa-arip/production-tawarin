import{r as d,R as B}from"./app.c4d8ffef.js";import{S as Y,D,y as k,o as c,u as E,l as H,p as N,R as ce,X as M,s as fe,c as q}from"./use-flags.d067abcf.js";import{h as ve,T as xe,I as K,e as be,o as m,r as me,a as ge}from"./keyboard.cf61903e.js";import{i as Z}from"./use-computed.c3a13bbd.js";import{L as Oe,s as Re,u as Se,a as y,x as he}from"./DropdownMenu.8bf6b923.js";import{c as Le,d as V,C as ye}from"./transition.ba6196d3.js";import{c as Ie,p as $e}from"./hidden.a5f81d1f.js";import{T as Te,e as Pe}from"./use-controllable.92b01cf7.js";var Ce=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(Ce||{}),Ee=(e=>(e[e.Single=0]="Single",e[e.Multi=1]="Multi",e))(Ee||{}),we=(e=>(e[e.Pointer=0]="Pointer",e[e.Other=1]="Other",e))(we||{}),De=(e=>(e[e.OpenListbox=0]="OpenListbox",e[e.CloseListbox=1]="CloseListbox",e[e.GoToOption=2]="GoToOption",e[e.Search=3]="Search",e[e.ClearSearch=4]="ClearSearch",e[e.RegisterOption=5]="RegisterOption",e[e.UnregisterOption=6]="UnregisterOption",e[e.RegisterLabel=7]="RegisterLabel",e))(De||{});function j(e,i=a=>a){let a=e.activeOptionIndex!==null?e.options[e.activeOptionIndex]:null,r=ge(i(e.options.slice()),u=>u.dataRef.current.domRef.current),l=a?r.indexOf(a):null;return l===-1&&(l=null),{options:r,activeOptionIndex:l}}let ke={[1](e){return e.dataRef.current.disabled||e.listboxState===1?e:{...e,activeOptionIndex:null,listboxState:1}},[0](e){if(e.dataRef.current.disabled||e.listboxState===0)return e;let i=e.activeOptionIndex,{isSelected:a}=e.dataRef.current,r=e.options.findIndex(l=>a(l.dataRef.current.value));return r!==-1&&(i=r),{...e,listboxState:0,activeOptionIndex:i}},[2](e,i){var a;if(e.dataRef.current.disabled||e.listboxState===1)return e;let r=j(e),l=he(i,{resolveItems:()=>r.options,resolveActiveIndex:()=>r.activeOptionIndex,resolveId:u=>u.id,resolveDisabled:u=>u.dataRef.current.disabled});return{...e,...r,searchQuery:"",activeOptionIndex:l,activationTrigger:(a=i.trigger)!=null?a:1}},[3]:(e,i)=>{if(e.dataRef.current.disabled||e.listboxState===1)return e;let a=e.searchQuery!==""?0:1,r=e.searchQuery+i.value.toLowerCase(),l=(e.activeOptionIndex!==null?e.options.slice(e.activeOptionIndex+a).concat(e.options.slice(0,e.activeOptionIndex+a)):e.options).find(t=>{var n;return!t.dataRef.current.disabled&&((n=t.dataRef.current.textValue)==null?void 0:n.startsWith(r))}),u=l?e.options.indexOf(l):-1;return u===-1||u===e.activeOptionIndex?{...e,searchQuery:r}:{...e,searchQuery:r,activeOptionIndex:u,activationTrigger:1}},[4](e){return e.dataRef.current.disabled||e.listboxState===1||e.searchQuery===""?e:{...e,searchQuery:""}},[5]:(e,i)=>{let a={id:i.id,dataRef:i.dataRef},r=j(e,l=>[...l,a]);return e.activeOptionIndex===null&&e.dataRef.current.isSelected(i.dataRef.current.value)&&(r.activeOptionIndex=r.options.indexOf(a)),{...e,...r}},[6]:(e,i)=>{let a=j(e,r=>{let l=r.findIndex(u=>u.id===i.id);return l!==-1&&r.splice(l,1),r});return{...e,...a,activationTrigger:1}},[7]:(e,i)=>({...e,labelId:i.id})},G=d.exports.createContext(null);G.displayName="ListboxActionsContext";function F(e){let i=d.exports.useContext(G);if(i===null){let a=new Error(`<${e} /> is missing a parent <Listbox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(a,F),a}return i}let J=d.exports.createContext(null);J.displayName="ListboxDataContext";function Q(e){let i=d.exports.useContext(J);if(i===null){let a=new Error(`<${e} /> is missing a parent <Listbox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(a,Q),a}return i}function Me(e,i){return E(i.type,ke,e,i)}let Fe=d.exports.Fragment;function Qe(e,i){let{value:a,defaultValue:r,form:l,name:u,onChange:t,by:n=(s,p)=>s===p,disabled:x=!1,horizontal:g=!1,multiple:O=!1,...I}=e;const T=g?"horizontal":"vertical";let P=k(i),[R=O?[]:void 0,$]=Te(a,t,r),[f,o]=d.exports.useReducer(Me,{dataRef:d.exports.createRef(),listboxState:1,options:[],searchQuery:"",labelId:null,activeOptionIndex:null,activationTrigger:1}),v=d.exports.useRef({static:!1,hold:!1}),C=d.exports.useRef(null),X=d.exports.useRef(null),S=d.exports.useRef(null),L=c(typeof n=="string"?(s,p)=>{let h=n;return(s==null?void 0:s[h])===(p==null?void 0:p[h])}:n),A=d.exports.useCallback(s=>E(b.mode,{[1]:()=>R.some(p=>L(p,s)),[0]:()=>L(R,s)}),[R]),b=d.exports.useMemo(()=>({...f,value:R,disabled:x,mode:O?1:0,orientation:T,compare:L,isSelected:A,optionsPropsRef:v,labelRef:C,buttonRef:X,optionsRef:S}),[R,x,O,f]);H(()=>{f.dataRef.current=b},[b]),Oe([b.buttonRef,b.optionsRef],(s,p)=>{var h;o({type:1}),ve(p,xe.Loose)||(s.preventDefault(),(h=b.buttonRef.current)==null||h.focus())},b.listboxState===0);let _=d.exports.useMemo(()=>({open:b.listboxState===0,disabled:x,value:R}),[b,x,R]),ee=c(s=>{let p=b.options.find(h=>h.id===s);p&&w(p.dataRef.current.value)}),te=c(()=>{if(b.activeOptionIndex!==null){let{dataRef:s,id:p}=b.options[b.activeOptionIndex];w(s.current.value),o({type:2,focus:y.Specific,id:p})}}),oe=c(()=>o({type:0})),re=c(()=>o({type:1})),ne=c((s,p,h)=>s===y.Specific?o({type:2,focus:y.Specific,id:p,trigger:h}):o({type:2,focus:s,trigger:h})),ie=c((s,p)=>(o({type:5,id:s,dataRef:p}),()=>o({type:6,id:s}))),ae=c(s=>(o({type:7,id:s}),()=>o({type:7,id:null}))),w=c(s=>E(b.mode,{[0](){return $==null?void 0:$(s)},[1](){let p=b.value.slice(),h=p.findIndex(z=>L(z,s));return h===-1?p.push(s):p.splice(h,1),$==null?void 0:$(p)}})),le=c(s=>o({type:3,value:s})),se=c(()=>o({type:4})),ue=d.exports.useMemo(()=>({onChange:w,registerOption:ie,registerLabel:ae,goToOption:ne,closeListbox:re,openListbox:oe,selectActiveOption:te,selectOption:ee,search:le,clearSearch:se}),[]),pe={ref:P},U=d.exports.useRef(null),de=N();return d.exports.useEffect(()=>{U.current&&r!==void 0&&de.addEventListener(U.current,"reset",()=>{w(r)})},[U,w]),B.createElement(G.Provider,{value:ue},B.createElement(J.Provider,{value:b},B.createElement(Le,{value:E(b.listboxState,{[0]:V.Open,[1]:V.Closed})},u!=null&&R!=null&&Pe({[u]:R}).map(([s,p],h)=>B.createElement(Ie,{features:$e.Hidden,ref:h===0?z=>{var W;U.current=(W=z==null?void 0:z.closest("form"))!=null?W:null}:void 0,...ce({key:s,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:l,name:s,value:p})})),M({ourProps:pe,theirProps:I,slot:_,defaultTag:Fe,name:"Listbox"}))))}let Ae="button";function Ue(e,i){var a;let r=K(),{id:l=`headlessui-listbox-button-${r}`,...u}=e,t=Q("Listbox.Button"),n=F("Listbox.Button"),x=k(t.buttonRef,i),g=N(),O=c(f=>{switch(f.key){case m.Space:case m.Enter:case m.ArrowDown:f.preventDefault(),n.openListbox(),g.nextFrame(()=>{t.value||n.goToOption(y.First)});break;case m.ArrowUp:f.preventDefault(),n.openListbox(),g.nextFrame(()=>{t.value||n.goToOption(y.Last)});break}}),I=c(f=>{switch(f.key){case m.Space:f.preventDefault();break}}),T=c(f=>{if(me(f.currentTarget))return f.preventDefault();t.listboxState===0?(n.closeListbox(),g.nextFrame(()=>{var o;return(o=t.buttonRef.current)==null?void 0:o.focus({preventScroll:!0})})):(f.preventDefault(),n.openListbox())}),P=Z(()=>{if(t.labelId)return[t.labelId,l].join(" ")},[t.labelId,l]),R=d.exports.useMemo(()=>({open:t.listboxState===0,disabled:t.disabled,value:t.value}),[t]),$={ref:x,id:l,type:Re(e,t.buttonRef),"aria-haspopup":"listbox","aria-controls":(a=t.optionsRef.current)==null?void 0:a.id,"aria-expanded":t.disabled?void 0:t.listboxState===0,"aria-labelledby":P,disabled:t.disabled,onKeyDown:O,onKeyUp:I,onClick:T};return M({ourProps:$,theirProps:u,slot:R,defaultTag:Ae,name:"Listbox.Button"})}let ze="label";function Be(e,i){let a=K(),{id:r=`headlessui-listbox-label-${a}`,...l}=e,u=Q("Listbox.Label"),t=F("Listbox.Label"),n=k(u.labelRef,i);H(()=>t.registerLabel(r),[r]);let x=c(()=>{var O;return(O=u.buttonRef.current)==null?void 0:O.focus({preventScroll:!0})}),g=d.exports.useMemo(()=>({open:u.listboxState===0,disabled:u.disabled}),[u]);return M({ourProps:{ref:n,id:r,onClick:x},theirProps:l,slot:g,defaultTag:ze,name:"Listbox.Label"})}let He="ul",Ne=Y.RenderStrategy|Y.Static;function Ve(e,i){var a;let r=K(),{id:l=`headlessui-listbox-options-${r}`,...u}=e,t=Q("Listbox.Options"),n=F("Listbox.Options"),x=k(t.optionsRef,i),g=N(),O=N(),I=ye(),T=(()=>I!==null?(I&V.Open)===V.Open:t.listboxState===0)();d.exports.useEffect(()=>{var o;let v=t.optionsRef.current;v&&t.listboxState===0&&v!==((o=be(v))==null?void 0:o.activeElement)&&v.focus({preventScroll:!0})},[t.listboxState,t.optionsRef]);let P=c(o=>{switch(O.dispose(),o.key){case m.Space:if(t.searchQuery!=="")return o.preventDefault(),o.stopPropagation(),n.search(o.key);case m.Enter:if(o.preventDefault(),o.stopPropagation(),t.activeOptionIndex!==null){let{dataRef:v}=t.options[t.activeOptionIndex];n.onChange(v.current.value)}t.mode===0&&(n.closeListbox(),q().nextFrame(()=>{var v;return(v=t.buttonRef.current)==null?void 0:v.focus({preventScroll:!0})}));break;case E(t.orientation,{vertical:m.ArrowDown,horizontal:m.ArrowRight}):return o.preventDefault(),o.stopPropagation(),n.goToOption(y.Next);case E(t.orientation,{vertical:m.ArrowUp,horizontal:m.ArrowLeft}):return o.preventDefault(),o.stopPropagation(),n.goToOption(y.Previous);case m.Home:case m.PageUp:return o.preventDefault(),o.stopPropagation(),n.goToOption(y.First);case m.End:case m.PageDown:return o.preventDefault(),o.stopPropagation(),n.goToOption(y.Last);case m.Escape:return o.preventDefault(),o.stopPropagation(),n.closeListbox(),g.nextFrame(()=>{var v;return(v=t.buttonRef.current)==null?void 0:v.focus({preventScroll:!0})});case m.Tab:o.preventDefault(),o.stopPropagation();break;default:o.key.length===1&&(n.search(o.key),O.setTimeout(()=>n.clearSearch(),350));break}}),R=Z(()=>{var o,v,C;return(C=(o=t.labelRef.current)==null?void 0:o.id)!=null?C:(v=t.buttonRef.current)==null?void 0:v.id},[t.labelRef.current,t.buttonRef.current]),$=d.exports.useMemo(()=>({open:t.listboxState===0}),[t]),f={"aria-activedescendant":t.activeOptionIndex===null||(a=t.options[t.activeOptionIndex])==null?void 0:a.id,"aria-multiselectable":t.mode===1?!0:void 0,"aria-labelledby":R,"aria-orientation":t.orientation,id:l,onKeyDown:P,role:"listbox",tabIndex:0,ref:x};return M({ourProps:f,theirProps:u,slot:$,defaultTag:He,features:Ne,visible:T,name:"Listbox.Options"})}let Ke="li";function Xe(e,i){let a=K(),{id:r=`headlessui-listbox-option-${a}`,disabled:l=!1,value:u,...t}=e,n=Q("Listbox.Option"),x=F("Listbox.Option"),g=n.activeOptionIndex!==null?n.options[n.activeOptionIndex].id===r:!1,O=n.isSelected(u),I=d.exports.useRef(null),T=fe({disabled:l,value:u,domRef:I,get textValue(){var S,L;return(L=(S=I.current)==null?void 0:S.textContent)==null?void 0:L.toLowerCase()}}),P=k(i,I);H(()=>{if(n.listboxState!==0||!g||n.activationTrigger===0)return;let S=q();return S.requestAnimationFrame(()=>{var L,A;(A=(L=I.current)==null?void 0:L.scrollIntoView)==null||A.call(L,{block:"nearest"})}),S.dispose},[I,g,n.listboxState,n.activationTrigger,n.activeOptionIndex]),H(()=>x.registerOption(r,T),[T,r]);let R=c(S=>{if(l)return S.preventDefault();x.onChange(u),n.mode===0&&(x.closeListbox(),q().nextFrame(()=>{var L;return(L=n.buttonRef.current)==null?void 0:L.focus({preventScroll:!0})}))}),$=c(()=>{if(l)return x.goToOption(y.Nothing);x.goToOption(y.Specific,r)}),f=Se(),o=c(S=>f.update(S)),v=c(S=>{f.wasMoved(S)&&(l||g||x.goToOption(y.Specific,r,0))}),C=c(S=>{f.wasMoved(S)&&(l||g&&x.goToOption(y.Nothing))}),X=d.exports.useMemo(()=>({active:g,selected:O,disabled:l}),[g,O,l]);return M({ourProps:{id:r,ref:P,role:"option",tabIndex:l===!0?void 0:-1,"aria-disabled":l===!0?!0:void 0,"aria-selected":O,disabled:void 0,onClick:R,onFocus:$,onPointerEnter:o,onMouseEnter:o,onPointerMove:v,onMouseMove:v,onPointerLeave:C,onMouseLeave:C},theirProps:t,slot:X,defaultTag:Ke,name:"Listbox.Option"})}let je=D(Qe),qe=D(Ue),Ge=D(Be),Je=D(Ve),We=D(Xe),it=Object.assign(je,{Button:qe,Label:Ge,Options:Je,Option:We});export{it as H};
