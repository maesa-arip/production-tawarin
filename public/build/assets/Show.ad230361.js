import{u as p,a as l,j as e,H as g,L as x,r as c,b as y,d as j}from"./app.d3793d70.js";import"./DropdownMenu.7258a43e.js";import"./Dropdown.55ddbf4d.js";import"./index.c7b064e3.js";import{A as k}from"./ApplicationLogo.7840e881.js";import"./clsx.m.256e9345.js";import"./transition.6ce44c33.js";import"./use-owner.5646d69c.js";import"./Tawarin.08057ae7.js";function S({title:i,children:r}){const{users:n,auth:a,roles:d}=p().props;return l("div",{className:"flex h-screen antialiased text-gray-800",children:[e(g,{title:i}),l("div",{className:"h-full w-full overflow-x-hidden",children:[l("div",{className:"hidden md:flex flex-col py-8 pl-6 pr-2 w-64 bg-white flex-shrink-0",children:[e("div",{className:"flex flex-row items-center justify-center h-12 w-full",children:e(x,{className:"ml-2 text-2xl font-bold",href:route("chats.index"),children:"Chat"})}),l("div",{className:"flex flex-col items-center bg-indigo-100 border border-gray-200 mt-4 w-full py-6 px-4 rounded-lg",children:[e("div",{className:"h-20 w-20 rounded-full border overflow-hidden",children:e("div",{className:"flex items-center justify-center w-full h-full text-2xl font-semibold bg-indigo-200 rounded-full",children:Array.from(a.user.name)[0]})}),e("div",{className:"text-sm font-semibold mt-2",children:a.user.name}),e("div",{className:"text-xs text-gray-500",children:d.map(t=>t.name)}),l("div",{className:"flex flex-row items-center mt-3",children:[e("div",{className:"flex flex-col justify-center h-4 w-8 bg-indigo-500 rounded-full",children:e("div",{className:"h-3 w-3 bg-white rounded-full self-end mr-1"})}),e("div",{className:"leading-none ml-1 text-xs",children:"Active"})]})]}),l("div",{className:"flex flex-col mt-8",children:[e("div",{className:"flex flex-row items-center justify-between text-xs",children:e("span",{className:"font-bold",children:"Contact"})}),e("div",{className:"flex flex-col space-y-1 mt-4 -mx-2 h-48 overflow-y-auto",children:n.map(t=>l(x,{href:route("chats.show",t.username),className:`block ${route().current("chats.show",t.username)?"flex flex-row items-center bg-gray-100 rounded-xl p-2":"flex flex-row items-center hover:bg-gray-100 rounded-xl p-2"}`,children:[e("div",{className:"flex items-center justify-center w-8 h-8 bg-indigo-200 rounded-full",children:Array.from(t.name)[0]}),e("div",{className:"ml-2 text-sm font-semibold",children:t.name})]},t.id))})]})]}),r]})]})}const m=(i,r,n="justify")=>{if(n=="justify")return i===r?"col-start-1 col-end-8 md:p-3 rounded-lg":"col-start-6 col-end-13 md:p-3 rounded-lg";if(n=="background")return i===r?"relative md:ml-3 text-sm bg-white text-gray-900 py-2 px-4 shadow rounded-xl":"relative md:mr-3 text-sm bg-green-100 text-green-900 py-2 px-4 shadow rounded-xl";if(n=="col")return i===r?"flex flex-row items-center":"flex items-center justify-start flex-row-reverse"};function T(i){const{auth:r}=p().props,[n,a]=c.exports.useState(!1),d=c.exports.useRef(null),t=c.exports.useRef(null),{user:o,chats:f}=i,{data:u,setData:v,reset:w,errors:A,post:N}=y({message:""}),h=s=>{s.preventDefault(),N(route("chats.store",o.username),{onSuccess:()=>{w("message"),d.current.scrollTo(0,9999999)}})},b=()=>{setTimeout(()=>{Echo.private(`chats.${o.uuid}`).whisper("isTyping",{name:o.name})},500)};return Echo.private("chats."+r.user.uuid).listenForWhisper("isTyping",s=>{a(!0),setTimeout(()=>a(!1),5e3)}).listen("MessageSent",({chat:s})=>{j.Inertia.reload({preserveScroll:!0,onSuccess:()=>{d.current.scrollTo(0,9999999),a(!1)}})}),c.exports.useEffect(()=>{d.current.scrollTo(0,9999999),t.current.focus()},[]),l("div",{className:"flex flex-col flex-auto h-full p-6",children:[e(g,{title:`Chat with ${o.name}`}),l("div",{className:"flex flex-col flex-auto flex-shrink-0 h-full p-4 bg-gray-100 rounded-2xl",children:[l("div",{className:"p-4 border-b",children:[e("div",{className:"md:hidden",children:e(k,{})}),l("div",{className:"items-center hidden md:flex",children:[e("div",{className:"flex items-center justify-center w-10 h-10 mx-4 text-2xl font-semibold bg-indigo-200 rounded-full",children:Array.from(o.name)[0]}),e("h1",{className:"font-semibold",children:o.name})]}),n&&e("div",{className:"text-xs text-gray-500",children:"is typing . . ."})]}),e("div",{className:"flex flex-col h-full mb-4 overflow-x-auto",children:e("div",{className:"flex flex-col h-full",children:e("div",{className:"grid grid-cols-12 overflow-y-auto gap-y-2",ref:d,children:f.length?f.map(s=>e("div",{className:`${m(r.user.id,s.sender_id)}`,children:e("div",{className:`md:p-4 rounded-xl ${m(r.user.id,s.sender_id,"col")}`,children:e("div",{className:`md:p-4 rounded-xl ${m(r.user.id,s.sender_id,"background")}`,children:s.message})})},s.id)):e("div",{className:"text-gray-500 md:ml-3",children:"Start chat . . ."})})})}),e("form",{onSubmit:h,children:l("div",{className:"flex flex-row items-center w-full h-16 px-4 bg-white rounded-xl",children:[e("div",{}),e("div",{className:"flex-grow ml-4",children:e("div",{className:"relative w-full",children:e("input",{onKeyUp:b,ref:t,value:u.message,autoComplete:"off",onChange:s=>v({...u,message:s.target.value}),type:"text",placeholder:"Start typing . . . ",name:"message",id:"message",className:"flex w-full h-10 pl-4 border rounded-xl focus:outline-none focus:border-indigo-300"})})}),e("div",{className:"ml-4",children:l("button",{onSubmit:h,className:"flex items-center justify-center flex-shrink-0 px-4 py-1 text-white bg-indigo-500 hover:bg-indigo-600 rounded-xl",children:[e("span",{className:"hidden md:block",children:"Send"}),e("span",{className:"py-1 ml-1 md:ml-2",children:e("svg",{className:"w-4 h-4 -mt-px transform rotate-45",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]})})]})})]})]})}T.layout=i=>e(S,{children:i});export{T as default};
