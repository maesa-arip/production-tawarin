import{u as w,r as n,b as y,d as N,a,j as e,H as b}from"./app.de533d93.js";import"./DropdownMenu.1f55bf2f.js";import"./index_responsive.07f2af3e.js";import{A as S}from"./AppChat.4671a8e8.js";import"./clsx.m.256e9345.js";import"./transition.42c66336.js";import"./use-event-listener.dd3c9a06.js";import"./Tawarin.08057ae7.js";import"./Aside.5023c736.js";const c=(l,r,i="justify")=>{if(i=="justify")return l===r?"col-start-1 col-end-8 md:p-3 rounded-lg":"col-start-6 col-end-13 md:p-3 rounded-lg";if(i=="background")return l===r?"relative md:ml-3 text-sm bg-white text-gray-900 py-2 px-4 shadow rounded-xl":"relative md:mr-3 text-sm bg-green-100 text-green-900 py-2 px-4 shadow rounded-xl";if(i=="col")return l===r?"flex flex-row items-center":"flex items-center justify-start flex-row-reverse"};function j(l){const{auth:r}=w().props,[i,d]=n.exports.useState(!1),o=n.exports.useRef(null),m=n.exports.useRef(null),{user:t,chats:u}=l,{data:f,setData:p,reset:x,errors:k,post:g}=y({message:""}),h=s=>{s.preventDefault(),g(route("chats.store",t.username),{onSuccess:()=>{x("message"),o.current.scrollTo(0,9999999)}})},v=()=>{setTimeout(()=>{Echo.private(`chats.${t.uuid}`).whisper("isTyping",{name:t.name})},500)};return Echo.private("chats."+r.user.uuid).listenForWhisper("isTyping",s=>{d(!0),setTimeout(()=>d(!1),5e3)}).listen("MessageSent",({chat:s})=>{N.Inertia.reload({preserveScroll:!0,onSuccess:()=>{o.current.scrollTo(0,9999999),d(!1)}})}),n.exports.useEffect(()=>{o.current.scrollTo(0,9999999),m.current.focus()},[]),a("div",{className:"flex flex-col flex-auto h-full p-6",children:[e(b,{title:`Chat with ${t.name}`}),a("div",{className:"flex flex-col flex-auto flex-shrink-0 h-full p-4 bg-gray-100 rounded-2xl",children:[a("div",{className:"p-4 border-b",children:[a("div",{className:"items-cente md:flex",children:[e("div",{className:"flex items-center justify-center w-10 h-10 text-2xl font-semibold bg-indigo-200 rounded-full",children:Array.from(t.name)[0]}),e("h1",{className:"font-semibold",children:t.name})]}),i&&e("div",{className:"text-xs text-gray-500",children:"is typing . . ."})]}),e("div",{className:"flex flex-col h-full mb-4 overflow-x-auto",children:e("div",{className:"flex flex-col h-full",children:e("div",{className:"grid grid-cols-12 mt-2 overflow-y-auto gap-y-2",ref:o,children:u.length?u.map(s=>e("div",{className:`${c(r.user.id,s.sender_id)}`,children:e("div",{className:`md:p-4 rounded-xl ${c(r.user.id,s.sender_id,"col")}`,children:e("div",{className:`md:p-4 rounded-xl ${c(r.user.id,s.sender_id,"background")}`,children:s.message})})},s.id)):e("div",{className:"text-gray-500 md:ml-3",children:"Start chat . . ."})})})}),e("form",{onSubmit:h,children:a("div",{className:"flex flex-row items-center w-full h-16 px-4 bg-white rounded-xl",children:[e("div",{}),e("div",{className:"flex-grow ml-4",children:e("div",{className:"relative w-full",children:e("input",{onKeyUp:v,ref:m,value:f.message,autoComplete:"off",onChange:s=>p({...f,message:s.target.value}),type:"text",placeholder:"Start typing . . . ",name:"message",id:"message",className:"flex w-full h-10 pl-4 border rounded-xl focus:outline-none focus:border-indigo-300"})})}),e("div",{className:"ml-4",children:a("button",{onSubmit:h,className:"flex items-center justify-center flex-shrink-0 px-4 py-1 text-white bg-indigo-500 hover:bg-indigo-600 rounded-xl",children:[e("span",{className:"hidden md:block",children:"Send"}),e("span",{className:"py-1 ml-1 md:ml-2",children:e("svg",{className:"w-4 h-4 -mt-px transform rotate-45",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]})})]})})]})]})}j.layout=l=>e(S,{children:l});export{j as default};
